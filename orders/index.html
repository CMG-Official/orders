<!DOCTYPE html>
<html>
<head>
<style>
    /* Styling for the Card */
    .order-card {
        background: #fff;
        border: 1px solid #ddd;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        font-family: sans-serif;
    }

    /* Customer Info Section */
    .customer-info {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 200px;
    }

    .pfp-img {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background-color: #eee;
        object-fit: cover;
        border: 2px solid #fff;
        box-shadow: 0 0 0 1px #ddd;
    }

    .user-details {
        display: flex;
        flex-direction: column;
    }

    .username-text { font-weight: 700; color: #333; }
    .userid-text { font-size: 0.8em; color: #888; }

    /* Buttons */
    .btn-group { display: flex; gap: 8px; }

    .btn-complete {
        background-color: #2ecc71; /* Green */
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.2s;
    }
    .btn-complete:hover { background-color: #27ae60; }

    .btn-cancel {
        background-color: #fff;
        color: #e74c3c;
        border: 1px solid #e74c3c;
        padding: 8px 12px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
    }
    .btn-cancel:hover { background-color: #fceceb; }

</style>
</head>
<body>

<div class="order-card" id="order-123">
    
    <div class="customer-info">
        <img src="https://tr.rbxcdn.com/53eb9b17fe1432a809c73a134d423984/150/150/AvatarHeadshot/Png" 
             id="pfp-12345678" 
             class="pfp-img" 
             alt="User">
        
        <div class="user-details">
            <span class="username-text" id="name-12345678">Loading...</span>
            <span class="userid-text">ID: 12345678</span>
        </div>
    </div>

    <div class="status-display">
        <span id="badge-123">In Progress</span>
    </div>

    <div class="btn-group">
        <button class="btn-complete" onclick="changeStatus('123', 'Completed')">
            ✅ Complete
        </button>
        <button class="btn-cancel" onclick="changeStatus('123', 'Canceled')">
            ✖ Cancel
        </button>
    </div>
</div>

<script>
    // 1. Fetch Roblox Profile Data automatically
    async function loadRobloxData(robloxId) {
        try {
            // Get PFP
            const pfpReq = await fetch(`https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${robloxId}&size=150x150&format=Png&isCircular=true`);
            const pfpRes = await pfpReq.json();
            if(pfpRes.data && pfpRes.data[0]) {
                document.getElementById(`pfp-${robloxId}`).src = pfpRes.data[0].imageUrl;
            }

            // Get Username
            const userReq = await fetch(`https://users.roblox.com/v1/users/${robloxId}`);
            const userRes = await userReq.json();
            if(userRes.name) {
                document.getElementById(`name-${robloxId}`).innerText = userRes.name;
            }
        } catch (e) {
            console.error("Roblox API Error:", e);
            document.getElementById(`name-${robloxId}`).innerText = "Unknown User";
        }
    }

    // 2. Handle Status Change
    function changeStatus(orderId, status) {
        if(!confirm(`Mark order #${orderId} as ${status}?`)) return;

        // Visual update immediately
        const badge = document.getElementById(`badge-${orderId}`);
        badge.innerText = status;
        
        if (status === 'Completed') {
            document.getElementById(`order-${orderId}`).style.opacity = "0.6"; // Dim completed orders
        }

        // Send to Backend (Replace with your actual endpoint)
        console.log(`Sending to backend: ID=${orderId}, Status=${status}`);
        // fetch('/api/update', { method: 'POST', body: JSON.stringify({id: orderId, status: status}) });
    }

    // Initialize (Call this for every order in your list)
    loadRobloxData(12345678); 
</script>

</body>
</html>
